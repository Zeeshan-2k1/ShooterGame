(()=>{"use strict";const t="ArrowUp",i="ArrowDown",e="lucky";const s=class{constructor(t,i,e){this.game=t,this.positionX=i,this.positionY=e,this.height=3,this.width=10,this.speed=5,this.markedForDeletion=!1,this.image=document.getElementById("projectile")}draw(t){this.game.debug&&t.strokeRect(this.positionX,this.positionY,this.width,this.height),t.drawImage(this.image,this.positionX,this.positionY)}update(){this.positionX+=this.speed,this.positionX>.85*this.game.width&&(this.markedForDeletion=!0)}};const h=class{constructor(t){this.game=t,this.width=120,this.height=190,this.positionX=20,this.positionY=100,this.maxSpeed=3,this.projectiles=[],this.image=document.getElementById("player"),this.frameX=0,this.frameY=0,this.maxFrame=37,this.powerUp=!1,this.powerTimer=0,this.powerLimit=8e3}draw(t){t.fillStyle="black",this.game.debug&&t.strokeRect(this.positionX,this.positionY,this.width,this.height),this.projectiles.forEach((i=>{i.draw(t)})),t.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.positionX,this.positionY,this.width,this.height)}updatePosition(e){this.game.keys.includes(t)&&(this.positionY-=this.maxSpeed),this.game.keys.includes(i)?this.positionY+=this.maxSpeed:this.positionY+=0,this.positionY>this.game.height-.5*this.height&&(this.positionY=this.game.height-.5*this.height),this.positionY<.5*-this.height&&(this.positionY=.5*-this.height),this.projectiles.forEach((t=>{t.update()})),this.projectiles=this.projectiles.filter((t=>!t.markedForDeletion)),this.frameX<this.maxFrame?this.frameX++:this.frameX=0,this.powerUp&&(this.powerTimer>=this.powerLimit?(this.powerUp=!1,this.powerTimer=0,this.frameY=0,this.game.sound.powerDown()):(this.frameY=1,this.game.gameOver||(this.game.ammo+=.1),Number.isNaN(e)||(this.powerTimer+=e)))}shootTop(){this.game.ammo>0&&(this.projectiles.push(new s(this.game,this.positionX+80,this.positionY+30)),this.game.ammo--),this.game.sound.shot(),this.powerUp&&this.shootBottom()}shootBottom(){this.game.ammo>0&&(this.projectiles.push(new s(this.game,this.positionX+80,this.positionY+175)),this.game.ammo--)}enterPowerUp(){this.powerUp=!0,this.powerTimer=0,this.game.ammo=this.game.maxAmmo,this.game.sound.powerUp()}};const o=class{constructor(e){this.game=e,window.addEventListener("keydown",(e=>{e.key!==t&&e.key!==i||-1!==this.game.keys.indexOf(e.key)?" "===e.key?this.game.player.shootTop():"d"===e.key?this.game.debug=!this.game.debug:"s"===e.key?this.game.startGame():"r"===e.key&&this.game.gameOver&&this.game.restartGame():this.game.keys.push(e.key)})),window.addEventListener("keyup",(t=>{this.game.keys.includes(t.key)>-1&&this.game.keys.splice(this.game.keys.indexOf(t.key),1)}))}},a=t=>Number(.001*t).toFixed(1);const r=class{constructor(t){this.game=t,this.fontSize=25,this.fontFamily="Bangers ",this.color="white"}draw(t){if(t.save(),t.fillStyle=this.color,t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowColor="black",t.font=this.fontSize+"px "+this.fontFamily,t.fillText("Score: "+this.game.score,20,40),t.fillText(`Timer: ${a(this.game.gameTime)}`,20,100),this.game.isGameStarted||(t.font="55px "+this.fontFamily,t.fillText("Press 'S' to start",.35*this.game.width,.5*this.game.height)),this.game.gameOver){let i,e;t.textAlign="center",this.game.score>this.game.winningScore?(i="Most Wondrous!",e="Well done explorer!"):(i="Blazes!",e="Get my repair kit and try again!"),t.font="70px "+this.fontFamily,t.fillText(i,.5*this.game.width,.5*this.game.height-20),t.font="25px "+this.fontFamily,t.fillText(e,.5*this.game.width,.5*this.game.height+20),t.font="55px "+this.fontFamily,t.fillText("Press 'R' to restart",.5*this.game.width,.5*this.game.height+120)}this.game.player.powerUp&&(t.fillStyle="#ffffbd");for(let i=0;i<this.game.ammo;i++)t.fillRect(20+5*i,50,3,20);t.restore()}};const m=class{constructor(t){this.game=t,this.positionX=this.game.width,this.speedX=-1.5*Math.random()-.5,this.markedForDeletion=!1,this.frameX=0,this.frameY=0,this.maxFrame=37}update(){this.positionX+=this.speedX-this.game.layerSpeed,this.positionX+this.width<0&&(this.markedForDeletion=!0),this.frameX<this.maxFrame?this.frameX++:this.frameX=0}draw(t){t.fillStyle="black",this.game.debug&&(t.strokeRect(this.positionX,this.positionY,this.width,this.height),t.fillStyle="black",t.font="20px",t.fillText(this.lives,this.positionX,this.positionY)),t.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.positionX,this.positionY,this.width,this.height)}};const n=class extends m{constructor(t){super(t),this.width=228,this.height=169,this.positionY=Math.random()*(.9*this.game.height-this.height),this.lives=2,this.score=2,this.image=document.getElementById("angler1"),this.frameY=Math.floor(3*Math.random())}},d=(t,i)=>t.positionX<i.positionX+i.width&&t.positionX+t.width>i.positionX&&t.positionY<i.positionY+i.height&&t.positionY+t.height>i.positionY;const p=class{constructor(t,i,e){this.game=t,this.image=i,this.speedModifier=e,this.width=1768,this.height=1600,this.x=0,this.y=0}update(){this.x<=-this.width&&(this.x=0),this.x-=this.game.layerSpeed*this.speedModifier}draw(t){t.drawImage(this.image,this.x,this.y),t.drawImage(this.image,this.x+this.width,this.y)}};const l=class{constructor(t){this.game=t,this.image1=document.getElementById("layer1"),this.image2=document.getElementById("layer2"),this.image3=document.getElementById("layer3"),this.image4=document.getElementById("layer4"),this.layer1=new p(t,this.image1,.2),this.layer2=new p(t,this.image2,.4),this.layer3=new p(t,this.image3,1),this.layer4=new p(t,this.image4,1.5),this.layers=[this.layer1,this.layer2,this.layer3,this.layer4]}update(){this.layers.forEach((t=>{t.update()}))}draw(t){this.layers.forEach((i=>{i.draw(t)}))}};const g=class extends m{constructor(t){super(t),this.width=213,this.height=165,this.positionY=Math.random()*(.9*this.game.height-this.height),this.lives=3,this.score=3,this.image=document.getElementById("angler2"),this.frameY=Math.floor(2*Math.random())}};const c=class extends m{constructor(t){super(t),this.width=99,this.height=95,this.positionY=Math.random()*(.9*this.game.height-this.height),this.lives=3,this.score=15,this.image=document.getElementById("lucky"),this.frameY=Math.floor(2*Math.random()),this.type=e}};const u=class{constructor(t,i,e){this.game=t,this.x=i,this.y=e,this.image=document.getElementById("gear"),this.frameX=Math.floor(3*Math.random()),this.frameY=Math.floor(3*Math.random()),this.spriteSize=50,this.sizeModifier=(.5*Math.random()+.5).toFixed(1),this.size=this.spriteSize*this.sizeModifier,this.speedX=6*Math.random()-3,this.speedY=-15*Math.random(),this.gravity=.5,this.markedForDeletion=!1,this.angle=0,this.va=.2*Math.random()-.1,this.bounced=0,this.bottomBounceBoundary=80*Math.random()+60}update(){this.angle+=this.va,this.speedY+=this.gravity,this.x-=this.speedX+this.game.layerSpeed,this.y+=this.speedY,(this.y>this.game.height+this.size||this.x<0-this.size)&&(this.markedForDeletion=!0),this.y>this.game.height-this.bottomBounceBoundary&&this.bounced<1&&(this.bounced++,this.speedY*=-.7)}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),t.drawImage(this.image,this.frameX*this.spriteSize,this.frameY*this.spriteSize,this.spriteSize,this.spriteSize,-.5*this.size,-.5*this.size,this.size,this.size),t.restore()}};const w=class extends m{constructor(t,i,e){super(t),this.width=115,this.height=95,this.y=Math.random()*(.95*this.game.height-this.height),this.image=document.getElementById("drone"),this.frameY=Math.floor(2*Math.random()),this.lives=3,this.score=this.lives,this.speedX=-4.2*Math.random()-.5}};const y=class{constructor(t,i,e){this.game=t,this.frameX=0,this.spriteWidth=200,this.spriteHeight=200,this.width=200,this.height=200,this.positionX=Number(i)-100,this.positionY=Number(e)-100,this.fps=30,this.timer=0,this.interval=1e3/this.fps,this.markedForDeletion=!1,this.maxFrame=8}update(t){this.positionX-=this.game.layerSpeed,this.timer>this.interval?(this.frameX++,this.timer=0):this.timer+=t,this.frameX>this.maxFrame&&(this.markedForDeletion=!0)}draw(t){t.drawImage(this.image,this.frameX*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.positionX,this.positionY,this.width,this.height)}};const f=class extends y{constructor(t,i,e){super(t,i,e),this.image=document.getElementById("smoke")}};const x=class extends y{constructor(t,i,e){super(t,i,e),this.image=document.getElementById("fire")}};const k=class{constructor(){this.powerUpSound=document.getElementById("powerup"),this.powerDownSound=document.getElementById("powerdown"),this.explosionSound=document.getElementById("explosion"),this.shotSound=document.getElementById("shot"),this.hitSound=document.getElementById("hit")}powerUp(){this.powerUpSound.currentTime=0,this.powerUpSound.play()}powerDown(){this.powerDownSound.currentTime=0,this.powerDownSound.play()}explosion(){this.explosionSound.currentTime=0,this.explosionSound.play()}shot(){this.shotSound.currentTime=0,this.shotSound.play()}hit(){this.hitSound.currentTime=0,this.hitSound.play()}};const X=class{constructor(t,i){this.height=t,this.width=i,this.player=new h(this),this.input=new o(this),this.ui=new r(this),this.background=new l(this),this.sound=new k(this),this.isGameStarted=!1,this.keys=[],this.enemies=[],this.particles=[],this.explosions=[],this.ammo=20,this.maxAmmo=50,this.ammoTimer=0,this.ammoInterval=300,this.enemyTimer=0,this.enemyInterval=500,this.gameOver=!1,this.score=0,this.winningScore=300,this.gameTime=0,this.timeLimit=6e4,this.layerSpeed=1,this.debug=!1}startGame(){this.isGameStarted=!0}restartGame(){delete this.player,delete this.input,delete this.ui,delete this.background,delete this.sound,this.player=new h(this),this.input=new o(this),this.ui=new r(this),this.background=new l(this),this.sound=new k(this),this.isGameStarted=!0,this.keys=[],this.enemies=[],this.particles=[],this.explosions=[],this.ammo=20,this.maxAmmo=50,this.ammoTimer=0,this.ammoInterval=300,this.enemyTimer=0,this.enemyInterval=500,this.gameOver=!1,this.score=0,this.winningScore=300,this.gameTime=0,this.timeLimit=6e4,this.layerSpeed=1}update(t){this.background.update(),this.player.updatePosition(t),this.isGameStarted&&(Number.isNaN(t)||this.gameOver||(this.gameTime+=t),this.gameTime>this.timeLimit&&(this.gameOver=!0),this.ammoTimer>this.ammoInterval?(this.ammo<this.maxAmmo&&this.ammo++,this.ammoTimer=0):Number.isNaN(t)||(this.ammoTimer+=t),this.explosions.forEach((i=>i.update(t))),this.explosions=this.explosions.filter((t=>!t.markedForDeletion)),this.particles.forEach((t=>t.update())),this.particles=this.particles.filter((t=>!t.markedForDeletion)),this.enemies.forEach((t=>{t.update(),d(this.player,t)&&(t.markedForDeletion=!0,this.addExplosion(t),this.sound.hit(),this.particles.push(new u(this,t.x+.5*t.width,t.y+.5*t.height)),t.type===e?this.player.enterPowerUp():this.gameOver||this.score--),this.player.projectiles.forEach((i=>{d(i,t)&&(i.markedForDeletion=!0,this.particles.push(new u(this,t.positionX+.5*t.width,t.positionY+.5*t.height)),t.lives--,t.lives<=0&&(t.markedForDeletion=!0,this.particles.push(new u(this,t.positionX+.5*t.width,t.positionY+.5*t.height)),this.addExplosion(t),this.sound.explosion(),this.gameOver||(this.score+=t.score),this.score>=this.winningScore&&(this.gameOver=!0)))}))})),this.enemies=this.enemies.filter((t=>!t.markedForDeletion)),this.enemyTimer>this.enemyInterval&&!this.gameOver?(this.addEnemy(),this.enemyTimer=0):Number.isNaN(t)||(this.enemyTimer+=t))}draw(t){this.background.draw(t),this.ui.draw(t),this.player.draw(t),this.particles.forEach((i=>{i.draw(t)})),this.enemies.forEach((i=>{i.draw(t)})),this.explosions.forEach((i=>{i.draw(t)}))}addEnemy(){const t=Math.random();t<.3?this.enemies.push(new n(this)):t<.6?this.enemies.push(new g(this)):t<.9?this.enemies.push(new w(this)):this.enemies.push(new c(this))}addExplosion(t){Math.random()<.5?this.explosions.push(new f(this,t.positionX+.5*t.width,t.positionY+.5*t.height)):this.explosions.push(new x(this,t.positionX+.5*t.width,t.positionY+.5*t.height))}};window.addEventListener("load",(function(){const t=document.getElementById("main"),i=t.getContext("2d");t.height=500,t.width=1200;const e=new X(t.height,t.width);let s=0;!function h(o){const a=o-s;s=o,i.clearRect(0,0,t.width,t.height),e.update(a),e.draw(i),requestAnimationFrame(h)}(0)}))})();